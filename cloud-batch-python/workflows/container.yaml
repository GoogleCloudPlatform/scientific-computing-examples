#workflow entrypoint
main:
  steps:
    - buildCreate:
        call: CloudBuildCreate
        args: 
          project: ${sys.get_env("GOOGLE_CLOUD_PROJECT")}
          build: 
            steps:
                - name: "gcr.io/google.com/cloudsdktool/cloud-sdk"
                  args:
                    - "-c"
                    - "gcloud onfig list"
            substitutions:
              _INSTANCE_NAME: ipreempt-nstance-1
              _ZONE: us-central1-a
        result: build
    - waitBuild:
        call: CloudBuildWaitOperation
        args:
          operation: ${build.name}
        result: build
    - final:
        return: ${build}